{"ast":null,"code":"import _regeneratorRuntime from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./share.css\";import PermMedia from\"@mui/icons-material/PermMedia\";import Label from\"@mui/icons-material/Label\";import Room from\"@mui/icons-material/Room\";import EmojiEmotions from\"@mui/icons-material/EmojiEmotions\";import{useContext,useRef,useState}from\"react\";import{AuthContext}from\"../../context/AuthContext\";import{ChildModal}from\"../modal/modalcomponent\";import{axiosInstance}from\"../../config\";import{getDownloadURL,ref,uploadBytes}from\"firebase/storage\";import{storage}from\"../../pages/Firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Share(){var _useContext=useContext(AuthContext),user=_useContext.user;var desc=useRef();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var submitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,fileName,imgRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={userId:user._id,desc:desc.current.value+\"\"};if(file){data=new FormData();fileName=file.name+Date.now();data.append(\"name\",fileName);data.append(\"file\",file);imgRef=ref(storage,\"images/\".concat(file.name+Date.now()));uploadBytes(imgRef,file).then(function(){getDownloadURL(imgRef).then(function(url){newPost.img=String(url);axiosInstance.post(\"/posts\",newPost).then(function(){window.location.reload();});});// console.log(newPost);\n});}else{axiosInstance.post(\"/posts\",newPost).then(function(){window.location.reload();});}case 3:case\"end\":return _context.stop();}}},_callee);}));return function submitHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"share\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"shareWrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"shareTop\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"shareProfileImg\",src:user.profilePicture?user.profilePicture:\"https://i.pinimg.com/736x/d9/56/9b/d9569bbed4393e2ceb1af7ba64fdf86a.jpg\",alt:\"\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"What's in your mind \"+user.username+\"?\",className:\"shareInput\",ref:desc})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"shareHr\"}),file&&/*#__PURE__*/_jsx(ChildModal,{file:file,setFile:setFile}),/*#__PURE__*/_jsxs(\"form\",{className:\"shareBottom\",onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"shareOptions\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file\",className:\"shareOption\",children:[/*#__PURE__*/_jsx(PermMedia,{htmlColor:\"tomato\",className:\"shareIcon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"shareOptionText\",children:\"Photo or Video\"}),/*#__PURE__*/_jsx(\"input\",{style:{display:\"none\"},type:\"file\",id:\"file\",accept:\".png,.jpeg,.jpg\",onChange:function onChange(e){return setFile(e.target.files[0]);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"shareOption\",children:[/*#__PURE__*/_jsx(Label,{htmlColor:\"blue\",className:\"shareIcon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"shareOptionText\",children:\"Tag\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"shareOption\",children:[/*#__PURE__*/_jsx(Room,{htmlColor:\"green\",className:\"shareIcon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"shareOptionText\",children:\"Location\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"shareOption\",children:[/*#__PURE__*/_jsx(EmojiEmotions,{htmlColor:\"goldenrod\",className:\"shareIcon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"shareOptionText\",children:\"Feelings\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"shareButton\",type:\"submit\",children:\"Share\"})]})]})});}","map":{"version":3,"names":["PermMedia","Label","Room","EmojiEmotions","useContext","useRef","useState","AuthContext","ChildModal","axiosInstance","getDownloadURL","ref","uploadBytes","storage","Share","user","desc","file","setFile","submitHandler","e","preventDefault","newPost","userId","_id","current","value","data","FormData","fileName","name","Date","now","append","imgRef","then","url","img","String","post","window","location","reload","profilePicture","username","display","target","files"],"sources":["D:/js/socialsite/SOCIALBOOK/connect/react-social/src/components/share/Share.jsx"],"sourcesContent":["import \"./share.css\";\r\nimport PermMedia from \"@mui/icons-material/PermMedia\";\r\nimport Label from \"@mui/icons-material/Label\";\r\nimport Room from \"@mui/icons-material/Room\";\r\nimport EmojiEmotions from \"@mui/icons-material/EmojiEmotions\";\r\n\r\nimport { useContext, useRef, useState } from \"react\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { ChildModal } from \"../modal/modalcomponent\";\r\nimport { axiosInstance } from \"../../config\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"firebase/storage\";\r\nimport { storage } from \"../../pages/Firebase\";\r\n\r\nexport default function Share() {\r\n  const { user } = useContext(AuthContext);\r\n\r\n  const desc = useRef();\r\n\r\n  const [file, setFile] = useState(null);\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n    const newPost = {\r\n      userId: user._id,\r\n      desc: desc.current.value + \"\",\r\n    };\r\n    if (file) {\r\n      const data = new FormData();\r\n      const fileName = file.name + Date.now();\r\n      data.append(\"name\", fileName);\r\n      data.append(\"file\", file);\r\n\r\n      const imgRef = ref(storage, `images/${file.name + Date.now()}`);\r\n\r\n      uploadBytes(imgRef, file).then(() => {\r\n        getDownloadURL(imgRef).then((url) => {\r\n          newPost.img = String(url);\r\n          axiosInstance.post(\"/posts\", newPost).then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n        // console.log(newPost);\r\n      });\r\n    } else {\r\n      axiosInstance.post(\"/posts\", newPost).then(() => {\r\n        window.location.reload();\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"share\">\r\n      <div className=\"shareWrapper\">\r\n        <div className=\"shareTop\">\r\n          <img\r\n            className=\"shareProfileImg\"\r\n            src={\r\n              user.profilePicture\r\n                ? user.profilePicture\r\n                : \"https://i.pinimg.com/736x/d9/56/9b/d9569bbed4393e2ceb1af7ba64fdf86a.jpg\"\r\n            }\r\n            alt=\"\"\r\n          />\r\n          <input\r\n            placeholder={\"What's in your mind \" + user.username + \"?\"}\r\n            className=\"shareInput\"\r\n            ref={desc}\r\n          />\r\n        </div>\r\n        <hr className=\"shareHr\" />\r\n        {file && <ChildModal file={file} setFile={setFile} />}\r\n        <form className=\"shareBottom\" onSubmit={submitHandler}>\r\n          <div className=\"shareOptions\">\r\n            <label htmlFor=\"file\" className=\"shareOption\">\r\n              <PermMedia htmlColor=\"tomato\" className=\"shareIcon\" />\r\n              <span className=\"shareOptionText\">Photo or Video</span>\r\n              <input\r\n                style={{ display: \"none\" }}\r\n                type=\"file\"\r\n                id=\"file\"\r\n                accept=\".png,.jpeg,.jpg\"\r\n                onChange={(e) => setFile(e.target.files[0])}\r\n              />\r\n            </label>\r\n            <div className=\"shareOption\">\r\n              <Label htmlColor=\"blue\" className=\"shareIcon\" />\r\n              <span className=\"shareOptionText\">Tag</span>\r\n            </div>\r\n            <div className=\"shareOption\">\r\n              <Room htmlColor=\"green\" className=\"shareIcon\" />\r\n              <span className=\"shareOptionText\">Location</span>\r\n            </div>\r\n            <div className=\"shareOption\">\r\n              <EmojiEmotions htmlColor=\"goldenrod\" className=\"shareIcon\" />\r\n              <span className=\"shareOptionText\">Feelings</span>\r\n            </div>\r\n          </div>\r\n          <button className=\"shareButton\" type=\"submit\">\r\n            Share\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}