{"ast":null,"code":"import _regeneratorRuntime from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./rightbar.css\";import{useContext,useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import ChatOnline from\"../../components/chatOnline/ChatOnline\";import Add from\"@mui/icons-material/Add\";import Remove from\"@mui/icons-material/Remove\";import{axiosInstance}from\"../../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Rightbar(_ref){var user=_ref.user,socket=_ref.socket;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),friends=_useState2[0],setFriends=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.user,dispatch=_useContext.dispatch;//console.log(currentUser);\nvar _useState3=useState(currentUser===null||currentUser===void 0?void 0:currentUser.followings.includes(user===null||user===void 0?void 0:user._id)),_useState4=_slicedToArray(_useState3,2),followed=_useState4[0],setFollowed=_useState4[1];console.log(followed);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),onlineUsers=_useState6[0],setOnlineUsers=_useState6[1];useEffect(function(){var getFriends=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var friendList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosInstance.get(\"/users/friends/\"+user._id);case 3:friendList=_context.sent;//console.log(friendList.data)\nsetFriends(friendList.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function getFriends(){return _ref2.apply(this,arguments);};}();getFriends();},[user]);useEffect(function(){var _socket$current;socket===null||socket===void 0?void 0:(_socket$current=socket.current)===null||_socket$current===void 0?void 0:_socket$current.on(\"getUsers\",function(users){setOnlineUsers(currentUser.followings.filter(function(f){return users.some(function(u){return u.userId===f;});}));});},[currentUser]);console.log(onlineUsers);var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _socket$current2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;if(!followed){_context2.next=7;break;}_context2.next=4;return axiosInstance.put(\"/users/unfollow/\".concat(user._id),{userId:currentUser._id});case 4:dispatch({type:\"UNFOLLOW\",payload:user._id});_context2.next=11;break;case 7:_context2.next=9;return axiosInstance.put(\"/users/follow/\".concat(user._id),{userId:currentUser._id});case 9:socket===null||socket===void 0?void 0:(_socket$current2=socket.current)===null||_socket$current2===void 0?void 0:_socket$current2.emit(\"friendRequest\",{senderName:currentUser.username,receiverId:user._id});dispatch({type:\"FOLLOW\",payload:user._id});case 11:setFollowed(!followed);_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,14]]);}));return function handleClick(){return _ref3.apply(this,arguments);};}();var HomeRightbar=function HomeRightbar(){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"birthdayContainer\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"birthdayImg\",src:\"assets/birthday.png\",alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"birthdayText\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Soumita Ganguly\"}),\" and \",/*#__PURE__*/_jsx(\"b\",{children:\"3 other friends\"}),\" have a birhday today.\"]})]}),/*#__PURE__*/_jsx(\"img\",{className:\"rightbarAd\",src:\"assets/shortcut-1.png\",alt:\"\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"Online Friends\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"rightbarFriendList\",children:/*#__PURE__*/_jsx(ChatOnline,{onlineUsers:onlineUsers,currentId:currentUser._id})})]});};var ProfileRightbar=function ProfileRightbar(){return/*#__PURE__*/_jsxs(_Fragment,{children:[user.username!==currentUser.username&&/*#__PURE__*/_jsxs(\"button\",{className:\"rightbarFollowButton\",onClick:handleClick,children:[followed?\"Unfollow\":\"Follow\",followed?/*#__PURE__*/_jsx(Remove,{}):/*#__PURE__*/_jsx(Add,{})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"User information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfo\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"City:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.city})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"From:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.from})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarInfoItem\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoKey\",children:\"Relationship:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarInfoValue\",children:user.relationship===1?\"Single\":user.relationship===1?\"Married\":\"-\"})]})]}),/*#__PURE__*/_jsx(\"h4\",{className:\"rightbarTitle\",children:\"User friends\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rightbarFollowings\",children:friends.map(function(friend){return/*#__PURE__*/_jsx(Link,{to:\"/profile/\"+friend._id,style:{textDecoration:\"none\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"rightbarFollowing\",children:[/*#__PURE__*/_jsx(\"img\",{src:friend.profilePicture?friend.profilePicture:\"https://i.pinimg.com/736x/d9/56/9b/d9569bbed4393e2ceb1af7ba64fdf86a.jpg\",alt:\"\",className:\"rightbarFollowingImg\"}),/*#__PURE__*/_jsx(\"span\",{className:\"rightbarFollowingName\",children:friend.username})]})});})})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"rightbar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rightbarWrapper\",children:user?/*#__PURE__*/_jsx(ProfileRightbar,{}):/*#__PURE__*/_jsx(HomeRightbar,{})})});}","map":{"version":3,"names":["useContext","useEffect","useState","Link","AuthContext","ChatOnline","Add","Remove","axiosInstance","Rightbar","user","socket","friends","setFriends","currentUser","dispatch","followings","includes","_id","followed","setFollowed","console","log","onlineUsers","setOnlineUsers","getFriends","get","friendList","data","current","on","users","filter","f","some","u","userId","handleClick","put","type","payload","emit","senderName","username","receiverId","HomeRightbar","ProfileRightbar","city","from","relationship","map","friend","textDecoration","profilePicture"],"sources":["D:/js/socialsite/SOCIALBOOK/connect/react-social/src/components/rightbar/Rightbar.jsx"],"sourcesContent":["import \"./rightbar.css\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport ChatOnline from \"../../components/chatOnline/ChatOnline\";\r\nimport Add from \"@mui/icons-material/Add\";\r\nimport Remove from \"@mui/icons-material/Remove\";\r\nimport { axiosInstance } from \"../../config\";\r\n\r\nexport default function Rightbar({ user, socket }) {\r\n  const [friends, setFriends] = useState([]);\r\n  const { user: currentUser, dispatch } = useContext(AuthContext);\r\n  //console.log(currentUser);\r\n  const [followed, setFollowed] = useState(\r\n    currentUser?.followings.includes(user?._id)\r\n  );\r\n  console.log(followed)\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n\r\n\r\n  useEffect(() => {\r\n    const getFriends = async () => {\r\n      try {\r\n        const friendList = await axiosInstance.get(\"/users/friends/\" + user._id);\r\n        //console.log(friendList.data)\r\n        setFriends(friendList.data);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    getFriends();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    socket?.current?.on(\"getUsers\", (users) => {\r\n      setOnlineUsers(\r\n        currentUser.followings.filter((f) => users.some((u) => u.userId === f))\r\n      );\r\n    });\r\n  }, [currentUser]);\r\n\r\n  console.log(onlineUsers)\r\n\r\n  const handleClick = async () => {\r\n    try {\r\n      if (followed) {\r\n\r\n        await axiosInstance.put(`/users/unfollow/${user._id}`, {\r\n          userId: currentUser._id,\r\n        });\r\n        dispatch({ type: \"UNFOLLOW\", payload: user._id });\r\n      } else {\r\n        await axiosInstance.put(`/users/follow/${user._id}`, {\r\n          userId: currentUser._id,\r\n        });\r\n        socket?.current?.emit(\"friendRequest\", {\r\n          senderName: currentUser.username,\r\n          receiverId: user._id,\r\n        })\r\n        dispatch({ type: \"FOLLOW\", payload: user._id });\r\n      }\r\n      setFollowed(!followed);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const HomeRightbar = () => {\r\n\r\n    return (\r\n      <>\r\n        <div className=\"birthdayContainer\">\r\n          <img className=\"birthdayImg\" src=\"assets/birthday.png\" alt=\"\" />\r\n          <span className=\"birthdayText\">\r\n            <b>Soumita Ganguly</b> and <b>3 other friends</b> have a birhday\r\n            today.\r\n          </span>\r\n        </div>\r\n        <img className=\"rightbarAd\" src=\"assets/shortcut-1.png\" alt=\"\" />\r\n        <h4 className=\"rightbarTitle\">Online Friends</h4>\r\n        <ul className=\"rightbarFriendList\">\r\n          <ChatOnline onlineUsers={onlineUsers} currentId={currentUser._id} />\r\n        </ul>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const ProfileRightbar = () => {\r\n    return (\r\n      <>\r\n        {user.username !== currentUser.username && (\r\n          <button className=\"rightbarFollowButton\" onClick={handleClick}>\r\n            {followed ? \"Unfollow\" : \"Follow\"}\r\n            {followed ? <Remove /> : <Add />}\r\n          </button>\r\n        )}\r\n        <h4 className=\"rightbarTitle\">User information</h4>\r\n        <div className=\"rightbarInfo\">\r\n          <div className=\"rightbarInfoItem\">\r\n            <span className=\"rightbarInfoKey\">City:</span>\r\n            <span className=\"rightbarInfoValue\">{user.city}</span>\r\n          </div>\r\n          <div className=\"rightbarInfoItem\">\r\n            <span className=\"rightbarInfoKey\">From:</span>\r\n            <span className=\"rightbarInfoValue\">{user.from}</span>\r\n          </div>\r\n          <div className=\"rightbarInfoItem\">\r\n            <span className=\"rightbarInfoKey\">Relationship:</span>\r\n            <span className=\"rightbarInfoValue\">\r\n              {user.relationship === 1\r\n                ? \"Single\"\r\n                : user.relationship === 1\r\n                  ? \"Married\"\r\n                  : \"-\"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <h4 className=\"rightbarTitle\">User friends</h4>\r\n        <div className=\"rightbarFollowings\">\r\n          {friends.map((friend) => (\r\n            <Link\r\n              to={\"/profile/\" + friend._id}\r\n              style={{ textDecoration: \"none\" }}\r\n            >\r\n              <div className=\"rightbarFollowing\">\r\n                <img\r\n                  src={\r\n                    friend.profilePicture\r\n                      ? friend.profilePicture\r\n                      : \"https://i.pinimg.com/736x/d9/56/9b/d9569bbed4393e2ceb1af7ba64fdf86a.jpg\"\r\n                  }\r\n                  alt=\"\"\r\n                  className=\"rightbarFollowingImg\"\r\n                />\r\n                <span className=\"rightbarFollowingName\">{friend.username}</span>\r\n              </div>\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n  return (\r\n    <div className=\"rightbar\">\r\n      <div className=\"rightbarWrapper\">\r\n        {user ? <ProfileRightbar /> : <HomeRightbar />}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}