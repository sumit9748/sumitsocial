{"ast":null,"code":"import _regeneratorRuntime from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import\"./status.css\";import{axiosInstance}from\"../../config\";import{storage}from\"../../pages/Firebase\";import AddIcon from\"@mui/icons-material/Add\";import{getDownloadURL,ref,uploadBytes}from\"firebase/storage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Status=function Status(_ref){var create=_ref.create,user=_ref.user,fetchStatus=_ref.fetchStatus,status=_ref.status;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var addStatus=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var newPost,data,fileName,imgRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newPost={userId:user._id,profilePic:user.profilePicture,userstatus:user.username};if(file){data=new FormData();fileName=file.name+Date.now();data.append(\"name\",fileName);data.append(\"file\",file);imgRef=ref(storage,\"images/\".concat(file.name+Date.now()));uploadBytes(imgRef,file).then(function(){getDownloadURL(imgRef).then(function(url){newPost.statusPic=String(url);axiosInstance.post(\"/status/\",newPost).then(function(){fetchStatus();});});// console.log(newPost);\n});}case 2:case\"end\":return _context.stop();}}},_callee);}));return function addStatus(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"statusComponent\",children:[/*#__PURE__*/_jsx(\"img\",{src:status===null||status===void 0?void 0:status.profilePic,alt:\"\",className:\"statusProfile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"back\",children:[/*#__PURE__*/_jsx(\"img\",{src:status===null||status===void 0?void 0:status.statusPic,alt:\"\"}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file\",children:[/*#__PURE__*/_jsx(\"input\",{style:{display:\"none\"},type:\"file\",id:\"file\",accept:\".png,.jpeg,.jpg\",onChange:function onChange(e){return setFile(e.target.files[0]);}}),create&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AddIcon,{className:\"statusAddIcon\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addStatus,className:\"statusAdder\",children:\"Share\"})]})]})]})]});};export default Status;","map":{"version":3,"names":["React","useState","axiosInstance","storage","AddIcon","getDownloadURL","ref","uploadBytes","Status","create","user","fetchStatus","status","file","setFile","addStatus","newPost","userId","_id","profilePic","profilePicture","userstatus","username","data","FormData","fileName","name","Date","now","append","imgRef","then","url","statusPic","String","post","display","e","target","files"],"sources":["D:/js/socialsite/SOCIALBOOK/connect/react-social/src/components/status/Status.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\n\r\nimport \"./status.css\";\r\nimport { axiosInstance } from \"../../config\";\r\nimport { storage } from \"../../pages/Firebase\";\r\nimport AddIcon from \"@mui/icons-material/Add\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"firebase/storage\";\r\n\r\nconst Status = ({ create, user, fetchStatus, status }) => {\r\n  const [file, setFile] = useState(null);\r\n\r\n  const addStatus = async () => {\r\n    const newPost = {\r\n      userId: user._id,\r\n      profilePic: user.profilePicture,\r\n      userstatus: user.username,\r\n    };\r\n\r\n    if (file) {\r\n      const data = new FormData();\r\n      const fileName = file.name + Date.now();\r\n      data.append(\"name\", fileName);\r\n      data.append(\"file\", file);\r\n\r\n      const imgRef = ref(storage, `images/${file.name + Date.now()}`);\r\n\r\n      uploadBytes(imgRef, file).then(() => {\r\n        getDownloadURL(imgRef).then((url) => {\r\n          newPost.statusPic = String(url);\r\n          axiosInstance.post(\"/status/\", newPost).then(() => {\r\n            fetchStatus();\r\n          });\r\n        });\r\n        // console.log(newPost);\r\n      });\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"statusComponent\">\r\n      <img src={status?.profilePic} alt=\"\" className=\"statusProfile\" />\r\n      <div className=\"back\">\r\n        <img src={status?.statusPic} alt=\"\" />\r\n        <label htmlFor=\"file\">\r\n          <input\r\n            style={{ display: \"none\" }}\r\n            type=\"file\"\r\n            id=\"file\"\r\n            accept=\".png,.jpeg,.jpg\"\r\n            onChange={(e) => setFile(e.target.files[0])}\r\n          />\r\n          {create && (\r\n            <>\r\n              <AddIcon className=\"statusAddIcon\" />\r\n\r\n              <button onClick={addStatus} className=\"statusAdder\">\r\n                Share\r\n              </button>\r\n            </>\r\n          )}\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Status;\r\n"],"mappings":"kfAAA,MAAOA,MAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,MAAO,cAAP,CACA,OAASC,aAAT,KAA8B,cAA9B,CACA,OAASC,OAAT,KAAwB,sBAAxB,CACA,MAAOC,QAAP,KAAoB,yBAApB,CACA,OAASC,cAAT,CAAyBC,GAAzB,CAA8BC,WAA9B,KAAiD,kBAAjD,C,6IAEA,GAAMC,OAAM,CAAG,QAATA,OAAS,MAA2C,IAAxCC,OAAwC,MAAxCA,MAAwC,CAAhCC,IAAgC,MAAhCA,IAAgC,CAA1BC,WAA0B,MAA1BA,WAA0B,CAAbC,MAAa,MAAbA,MAAa,CACxD,cAAwBX,QAAQ,CAAC,IAAD,CAAhC,wCAAOY,IAAP,eAAaC,OAAb,eAEA,GAAMC,UAAS,2FAAG,oKACVC,OADU,CACA,CACdC,MAAM,CAAEP,IAAI,CAACQ,GADC,CAEdC,UAAU,CAAET,IAAI,CAACU,cAFH,CAGdC,UAAU,CAAEX,IAAI,CAACY,QAHH,CADA,CAOhB,GAAIT,IAAJ,CAAU,CACFU,IADE,CACK,GAAIC,SAAJ,EADL,CAEFC,QAFE,CAESZ,IAAI,CAACa,IAAL,CAAYC,IAAI,CAACC,GAAL,EAFrB,CAGRL,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBJ,QAApB,EACAF,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBhB,IAApB,EAEMiB,MANE,CAMOxB,GAAG,CAACH,OAAD,kBAAoBU,IAAI,CAACa,IAAL,CAAYC,IAAI,CAACC,GAAL,EAAhC,EANV,CAQRrB,WAAW,CAACuB,MAAD,CAASjB,IAAT,CAAX,CAA0BkB,IAA1B,CAA+B,UAAM,CACnC1B,cAAc,CAACyB,MAAD,CAAd,CAAuBC,IAAvB,CAA4B,SAACC,GAAD,CAAS,CACnChB,OAAO,CAACiB,SAAR,CAAoBC,MAAM,CAACF,GAAD,CAA1B,CACA9B,aAAa,CAACiC,IAAd,CAAmB,UAAnB,CAA+BnB,OAA/B,EAAwCe,IAAxC,CAA6C,UAAM,CACjDpB,WAAW,GACZ,CAFD,EAGD,CALD,EAMA;AACD,CARD,EASD,CAxBe,sDAAH,kBAATI,UAAS,2CAAf,CA0BA,mBACE,aAAK,SAAS,CAAC,iBAAf,wBACE,YAAK,GAAG,CAAEH,MAAF,SAAEA,MAAF,iBAAEA,MAAM,CAAEO,UAAlB,CAA8B,GAAG,CAAC,EAAlC,CAAqC,SAAS,CAAC,eAA/C,EADF,cAEE,aAAK,SAAS,CAAC,MAAf,wBACE,YAAK,GAAG,CAAEP,MAAF,SAAEA,MAAF,iBAAEA,MAAM,CAAEqB,SAAlB,CAA6B,GAAG,CAAC,EAAjC,EADF,cAEE,eAAO,OAAO,CAAC,MAAf,wBACE,cACE,KAAK,CAAE,CAAEG,OAAO,CAAE,MAAX,CADT,CAEE,IAAI,CAAC,MAFP,CAGE,EAAE,CAAC,MAHL,CAIE,MAAM,CAAC,iBAJT,CAKE,QAAQ,CAAE,kBAACC,CAAD,QAAOvB,QAAO,CAACuB,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAd,EALZ,EADF,CAQG9B,MAAM,eACL,wCACE,KAAC,OAAD,EAAS,SAAS,CAAC,eAAnB,EADF,cAGE,eAAQ,OAAO,CAAEM,SAAjB,CAA4B,SAAS,CAAC,aAAtC,mBAHF,GATJ,GAFF,GAFF,GADF,CA0BD,CAvDD,CAyDA,cAAeP,OAAf"},"metadata":{},"sourceType":"module"}