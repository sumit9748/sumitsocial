{"ast":null,"code":"import _regeneratorRuntime from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/js/socialsite/SOCIALBOOK/connect/react-social/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useContext,useEffect,useState}from\"react\";import Post from\"../post/Post\";import Share from\"../share/Share\";import\"./feed.css\";import{AuthContext}from\"../../context/AuthContext\";import{axiosInstance}from\"../../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Feed(_ref){var username=_ref.username,text=_ref.text,socket=_ref.socket;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useContext=useContext(AuthContext),user=_useContext.user;useEffect(function(){fetchPosts();},[username,user._id]);var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!username){_context.next=6;break;}_context.next=3;return axiosInstance.get(\"/posts/profile/\"+username);case 3:_context.t0=_context.sent;_context.next=9;break;case 6:_context.next=8;return axiosInstance.get(\"/posts/timeline/\"+user._id);case 8:_context.t0=_context.sent;case 9:res=_context.t0;setPosts(res.data.sort(function(p1,p2){return new Date(p2.createdAt)-new Date(p1.createdAt);}));case 11:case\"end\":return _context.stop();}}},_callee);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();function deletePost(){fetchPosts();}return/*#__PURE__*/_jsx(\"div\",{className:\"feed\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"feedWrapper\",children:[(!username||username===user.username)&&/*#__PURE__*/_jsx(Share,{}),posts.filter(function(val){if(text===undefined){return val;}else if(val.desc.toLowerCase().includes(text.toLowerCase())){return val;}return null;}).map(function(p){return/*#__PURE__*/_jsx(Post,{post:p,deletePost:deletePost,socket:socket},p._id);})]})});}","map":{"version":3,"names":["useContext","useEffect","useState","Post","Share","AuthContext","axiosInstance","Feed","username","text","socket","posts","setPosts","user","fetchPosts","_id","get","res","data","sort","p1","p2","Date","createdAt","deletePost","filter","val","undefined","desc","toLowerCase","includes","map","p"],"sources":["D:/js/socialsite/SOCIALBOOK/connect/react-social/src/components/feed/Feed.jsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport Post from \"../post/Post\";\r\nimport Share from \"../share/Share\";\r\nimport \"./feed.css\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport { axiosInstance } from \"../../config\";\r\n\r\nexport default function Feed({ username, text, socket }) {\r\n  const [posts, setPosts] = useState([]);\r\n  const { user } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n\r\n    fetchPosts();\r\n  }, [username, user._id]);\r\n\r\n\r\n  const fetchPosts = async () => {\r\n    const res = username\r\n      ? await axiosInstance.get(\"/posts/profile/\" + username)\r\n      : await axiosInstance.get(\"/posts/timeline/\" + user._id);\r\n    setPosts(\r\n      res.data.sort((p1, p2) => {\r\n        return new Date(p2.createdAt) - new Date(p1.createdAt);\r\n      })\r\n    );\r\n  };\r\n\r\n\r\n  function deletePost() {\r\n    fetchPosts();\r\n  }\r\n\r\n  return (\r\n    <div className=\"feed\">\r\n      <div className=\"feedWrapper\">\r\n        {(!username || username === user.username) && <Share />}\r\n        {posts.filter((val) => {\r\n          if (text === undefined) {\r\n            return val;\r\n          } else if (val.desc.toLowerCase().includes(text.toLowerCase())) {\r\n            return val;\r\n          }\r\n          return null;\r\n        }\r\n        ).map((p) => (\r\n          <Post key={p._id} post={p} deletePost={deletePost} socket={socket} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"kfAAA,OAASA,UAAT,CAAqBC,SAArB,CAAgCC,QAAhC,KAAgD,OAAhD,CACA,MAAOC,KAAP,KAAiB,cAAjB,CACA,MAAOC,MAAP,KAAkB,gBAAlB,CACA,MAAO,YAAP,CACA,OAASC,WAAT,KAA4B,2BAA5B,CACA,OAASC,aAAT,KAA8B,cAA9B,C,wFAEA,cAAe,SAASC,KAAT,MAA0C,IAA1BC,SAA0B,MAA1BA,QAA0B,CAAhBC,IAAgB,MAAhBA,IAAgB,CAAVC,MAAU,MAAVA,MAAU,CACvD,cAA0BR,QAAQ,CAAC,EAAD,CAAlC,wCAAOS,KAAP,eAAcC,QAAd,eACA,gBAAiBZ,UAAU,CAACK,WAAD,CAA3B,CAAQQ,IAAR,aAAQA,IAAR,CAEAZ,SAAS,CAAC,UAAM,CAEda,UAAU,GACX,CAHQ,CAGN,CAACN,QAAD,CAAWK,IAAI,CAACE,GAAhB,CAHM,CAAT,CAMA,GAAMD,WAAU,2FAAG,+IACLN,QADK,+CAEPF,cAAa,CAACU,GAAd,CAAkB,kBAAoBR,QAAtC,CAFO,qFAGPF,cAAa,CAACU,GAAd,CAAkB,mBAAqBH,IAAI,CAACE,GAA5C,CAHO,yCACXE,GADW,aAIjBL,QAAQ,CACNK,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAc,SAACC,EAAD,CAAKC,EAAL,CAAY,CACxB,MAAO,IAAIC,KAAJ,CAASD,EAAE,CAACE,SAAZ,EAAyB,GAAID,KAAJ,CAASF,EAAE,CAACG,SAAZ,CAAhC,CACD,CAFD,CADM,CAAR,CAJiB,uDAAH,kBAAVT,WAAU,2CAAhB,CAYA,QAASU,WAAT,EAAsB,CACpBV,UAAU,GACX,CAED,mBACE,YAAK,SAAS,CAAC,MAAf,uBACE,aAAK,SAAS,CAAC,aAAf,WACG,CAAC,CAACN,QAAD,EAAaA,QAAQ,GAAKK,IAAI,CAACL,QAAhC,gBAA6C,KAAC,KAAD,IADhD,CAEGG,KAAK,CAACc,MAAN,CAAa,SAACC,GAAD,CAAS,CACrB,GAAIjB,IAAI,GAAKkB,SAAb,CAAwB,CACtB,MAAOD,IAAP,CACD,CAFD,IAEO,IAAIA,GAAG,CAACE,IAAJ,CAASC,WAAT,GAAuBC,QAAvB,CAAgCrB,IAAI,CAACoB,WAAL,EAAhC,CAAJ,CAAyD,CAC9D,MAAOH,IAAP,CACD,CACD,MAAO,KAAP,CACD,CAPA,EAQCK,GARD,CAQK,SAACC,CAAD,qBACJ,KAAC,IAAD,EAAkB,IAAI,CAAEA,CAAxB,CAA2B,UAAU,CAAER,UAAvC,CAAmD,MAAM,CAAEd,MAA3D,EAAWsB,CAAC,CAACjB,GAAb,CADI,EARL,CAFH,GADF,EADF,CAkBD"},"metadata":{},"sourceType":"module"}